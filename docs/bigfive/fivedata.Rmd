---
title: "Datalicious Depths of Delectable Data"
output: 
  html_document: 
    fig_caption: TRUE
date: "2023-08-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(tidyverse)
library(dplyr)
library(plotly)
library(ggplot2)
library(distill)
library(rmarkdown)
library(RColorBrewer)
library(formattable)
library(kableExtra)
library(patchwork)
library(gridExtra)
library(cowplot)
library(countrycode)
library(maps)


# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html

```


Want to jump to a specific question? 

- [Which results are the most common?](#popres)
- [How do results vary between countries?](#country) 
- [Are all questions created equal?](#questions)

### Which results are the most common? <a name="popres"></a>

See, if Open Psychometrics recorded the respondents' results, it would be quite quick to answer this question. Unfortunately, they didn't. So, we're working with a bunch of numbers! 

This is what the data looks like: 


```{r, initialdata, include=FALSE}
data <- read.csv("country.csv")
#data <- sapply(data[,!(names(data) %in% c("country"))], as.numeric)
#data["country"] <- as.character(data["country"])
options(scipen=10000) 
```

```{r, begin data}
paged_table(head(data))
```

I've selected the first 6 columns of the data set... and it's not too bad! It's a little intimidating to think that there are over 1 million more rows, but we've gotta start somewhere >:)

We start by calculating the scores for the 'Extroversion' personality trait. We can do this by summing up the scores of the 10 EXT (standing for EXTroversion) questions. However, it should be noted that answering a '4' or '5' on an EXT question doesn't always mean that a user is more extroverted. For example, answering 5 for "I don't talk a lot" vs. "I am the life of the party" would significantly affect your results. 

So, we'll need to make sure to add and subtract scores as necessary, depending on how the questions are keyed. I've arbitrarily decided to 
'positively key' questions symbolising extroversion (meaning that I'd add points to their total score if they showed signs of extroversion), and 'negatively key' questions symbolising introversion (subtracting points from their total score). See the table below to better understand this keying: 


```{r, exttablekey}

keyta = data.frame('Questions' = c("I am the life of the party.", "I don't talk a lot.", "I feel comfortable around people.", "I keep in the background.", "I start conversations.", "I have little to say.", "I talk to a lot of different people at parties.", "I don't like to draw attention to myself.", "I don't mind being the center of attention.", "I am quiet around strangers."), 
                    'Key' = c('$+$', "$-$", '$+$', "$-$",'$+$', "$-$",'$+$', "$-$",'$+$', "$-$"))

kable(keyta, caption = "EXT Question Key") %>%
  kable_styling()

## plus signs don't appear? 

```


Hence, after adding/subtracting their points from each question, any positive total score (> 0) means that the user receives an 'S' for Sociable, while a negative score (< 0) would result in an 'R' for reserved.^[Recall how introverted questions are negatively keyed and subtracted from your total.] If their score is 0, then they'd receive an 'X', as their results since they're perfectly in-between S and R, and will remain inconclusive.

Below is a sample table of results, where extletter (their final letter result) and extscore (the sum of their points) are calculated from the raw data. 

```{r, extdata}


exttable <- data %>% 
  select(starts_with('EXT'))  

exttable <- exttable %>% select(-c (ends_with('E'))) %>% 
  mutate(extscore = EXT1 - EXT2 + EXT3 - EXT4 + EXT5 - EXT6 + EXT7 - EXT8 + EXT9 - EXT10) %>% 
  mutate(extletter = 
    case_when(
      extscore > 0 ~ "S", 
      extscore < 0 ~ "R", 
      extscore == 0 ~ "X"
    )) %>%
  select(extletter, extscore, everything())
paged_table(head(exttable))

```

<br>
We can also visualize our results into a graph: 

```{r, extgraph}
exttable <- data %>% select(starts_with('EXT'))
exttable <- exttable %>% select(-c (ends_with('E'))) %>% 
  mutate(extscore = (EXT1-3) - (EXT2-3) + (EXT3-3) - (EXT4-3) + (EXT5-3) - (EXT6-3) + (EXT7-3) - (EXT8-3) + (EXT9-3) - (EXT10-3)) %>% 
  mutate(extletter = 
    case_when(
      extscore > 0 ~ "S", 
      extscore < 0 ~ "R", 
      extscore == 0 ~ "X"
    ))

dfext <- data.frame(extlettercount = c(500346, 468068, 45144),
                    extlettermap = c('R', 'S', 'X'))


 pext <- ggplot(data=dfext, aes(x=extlettermap, y=extlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Responders are More Introverted Than Extroverted",
     subtitle = "Introverts, give me a cheer! Wait... why is it silent? Where did the introverts go?") + 
   xlab("Possible Results") +
   ylab("Amount of Responses")+
   geom_text(aes(label=extlettercount), vjust=-0.3, size=3.5)+
   theme_minimal()
 pext

```

The same processes will be applied to the other personality traits, with their graphs located below: 


```{r, est}
 esttable <- data %>% select(starts_with('EST'))
 esttable <- esttable %>% select(-c (ends_with('E'))) %>%
   mutate(estscore = (EST2-3) - (EST1-3) - (EST3-3) + (EST4-3)  - (EST5-3)- (EST6-3)- (EST7-3)- (EST8-3)- (EST9-3)- (EST10-3)) %>%
   mutate(estletter =
            case_when(
              estscore > 0 ~ "C",
              estscore < 0 ~ "L",
              estscore == 0 ~ "X"
            ))
 
 dfest <- data.frame(estlettercount = c(517196, 452040, 44322),
                     estlettermap = c('L', 'C', 'X'))

 plotest <- ggplot(data=dfest, aes(x=estlettermap, y=estlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Respondents are More Prone
to Being Limbic Than Calm",
     subtitle = "Moody and a little bit groovy") + 
   xlab("Possible Results") +
   ylab("Amount of Responses")+
   geom_text(aes(label=estlettercount), vjust=-0.3, size=3.5)+
   theme_minimal()+
   scale_y_continuous(expand = c(0.1, 0))

```

```{r, csn}
 csntable <- data %>% 
  select(starts_with('CSN'))


 csntable <- csntable %>% select(-c (ends_with('E'))) %>% 
   mutate(csnscore = (CSN1-3) - (CSN2-3) + (CSN3-3) - (CSN4-3) + (CSN5-3) - (CSN6-3) + (CSN7-3) - (CSN8-3) + (CSN9-3) + (CSN10-3)) %>% 
   mutate(csnletter = 
            case_when(
              csnscore > 0 ~ "O", 
              csnscore < 0 ~ "U", 
              csnscore == 0 ~ "X"
            ))
 
 dfcsn <- data.frame(csnlettercount = c(662846, 302063, 48649),
                     csnlettermap = c('O', 'U', 'X'))
 
 pcsn <- ggplot(data=dfcsn, aes(x=csnlettermap, y=csnlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Responders Tend to be
Organized, Rather Than\nUnorganized",
     subtitle = "Control freaks reign supreme") + 
   xlab("Possible Letters") +
   ylab("Amount of Responses")+
   geom_text(aes(label=csnlettercount), vjust=-0.3, size=3.5) +
   theme_minimal()+
   scale_y_continuous(expand = c(0.1, 0)) 
 
 plot_grid(plotest, pcsn, ncol = 2, align = "hv")
 
```

```{r, agr}
 agrtable <- data %>% select(starts_with('AGR'))
 agrtable <- agrtable %>% select(-c (ends_with('E'))) %>% 
   mutate(agrscore = (AGR2-3) - (AGR1-3) + (AGR4-3) - (AGR3-3) + (AGR6-3) - (AGR5-3) + (AGR8-3) - (AGR7-3) + (AGR10-3) + (AGR9-3)) %>% 
   mutate(agrletter = 
            case_when(
              agrscore > 0 ~ "A", 
              agrscore < 0 ~ "E", 
              agrscore == 0 ~ "X"
            ))

dfagr <- data.frame(agrlettercount = c(846333, 140674, 26551),
                     agrlettermap = c('A', 'E', 'X'))
 
 plotagr <- ggplot(data=dfagr, aes(x=agrlettermap, y=agrlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Respondents Rate Themseleves
More Agreeable Than Egocentric",
     subtitle = "AKA: People like to think they're a lot nicer
than they actually are") + 
   xlab("Possible Letters") +
   ylab("Amount of Responses")+
   geom_text(aes(label=agrlettercount), vjust=-0.3, size=3.5) +
   theme_minimal()+
   scale_y_continuous(expand = c(0.1, 0))
 
```

```{r, opn}
 opntable <- data %>% select(starts_with('OPN'))
 opntable <- opntable %>% select(-c (ends_with('E'))) %>% 
   mutate(opnscore = (OPN1-3) - (OPN2-3) + (OPN3-3) - (OPN4-3) + (OPN5-3) - (OPN6-3) + (OPN7-3) + (OPN8-3) + (OPN9-3) + (OPN10-3)) %>% 
   mutate(opnletter = 
            case_when(
              opnscore > 0 ~ "I", 
              opnscore < 0 ~ "N", 
              opnscore == 0 ~ "X"
            )) 
 
dfopn <- data.frame(opnlettercount = c(902605, 85372, 25581),
                     opnlettermap = c('I', 'N', 'X'))
 
 plotopn <- ggplot(data=dfopn, aes(x=opnlettermap, y=opnlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "The Majourity Considers 
Themselves as Inquisitive",
     subtitle = "BREAKING: People like learning,\nschools are just ineffective...\nallegedly") + 
   xlab("Possible Letters") +
   ylab("Amount of Responses")+
   geom_text(aes(label=opnlettercount), vjust=-0.3, size=3.5) +
   theme_minimal() +
   theme(plot.margin = unit(c(0.5,0.5,0.5,1),"cm")) +
   scale_y_continuous(expand = c(0.1, 0))

#scale_x_continuous(limits = c(min(opnlettercount),max(opnlettercount)+5))


 
  plot_grid(plotagr, plotopn, ncol = 2, align = "hv")

 
```

Now, we can combine everybody's letters from each personality trait to form their final result. Then we can determine which results are the most common within this data set. 

In fact, we can see the 25 most common results below: 

```{r, combineresults}
finalletters <- c(paste(exttable$extletter, esttable$estletter, csntable$csnletter, agrtable$agrletter, opntable$opnletter, sep=""))
 finaltable <- data.frame(finalletters) 
  
 pfinaltable25 <- finaltable %>% 
   unnest(finalletters) %>%
   group_by(finalletters) %>%
   summarize(total = n()) %>%
   arrange(desc(total)) %>%
   slice(1:25)
 getPalette = colorRampPalette(brewer.pal(9, "Set1"))
 
  blank_theme <- theme_minimal()+
   theme(
     axis.title.x = element_blank(),
     axis.title.y = element_blank(),
   )
 
 bp25 <- ggplot(pfinaltable25, aes(x="", y=total, fill=reorder(finalletters, -total))) +
   geom_bar(width = 1, stat = "identity") +scale_fill_manual(values = getPalette(25))
 
 pie25 <- bp25 + coord_polar("y", start=0) 
 pie25 + blank_theme + theme(axis.text.x=element_blank()) +
   labs(title="Top 25 Most Common Results", 
        fill="Results")
 
```

<br>
WOOO! Out of the 243 possible answers, congratulations to the __OAI family for dominating the top 4 spots! 

If you'd prefer to see a more numerical representation, I've provided the table below with the top 10 results and the average score of each personality trait:^[The average values will actually shift every time I update the website (on RStudio!), as the function 'slice_sample' will grab the average of 100 randomly selected responses, resulting in a unique average every time!] 
<br>

```{r}

 pfinaltable <- finaltable %>% 
    unnest(finalletters) %>%
   group_by(finalletters) %>%
    summarize(total = n()) %>%
   arrange(desc(total)) %>%
   slice(1:10)
 
 pfinaltable <- pfinaltable %>% 
   mutate(percentage = total/1015342 * 100)

   
colnames(pfinaltable) <- c("Results", "Amount of Responses", "Percentage of People")
knitr::kable(pfinaltable,
             caption = "The 10 Most Common Results") %>% 
  kable_styling()
 
```

```{r, avgtrait}
#checking average score of each section 

avgscore <- cbind(exttable$extscore, esttable$estscore, csntable$csnscore, agrtable$agrscore, opntable$opnscore)
avgscore <- data.table::as.data.table(avgscore, .keep.rownames = "word")
  
avgscore <- slice_sample(avgscore, n=75) %>%
  colMeans() 

avgscore <- data.table::as.data.table(avgscore, .keep.rownames = "word")
avgscore <- as.data.frame(t(avgscore))

colnames(avgscore) <- c("Extroversion", "Neuroticism", "Conscientiousness", "Agreeableness", "Openness")

kable(avgscore, caption = "Average Score for Each Personliaty Trait") %>% 
  kable_styling()

```


### Let’s try to analyze why these results happened.

**Extrovertism**

Extrovertism is the most balanced trait, as there seems to be a nice mix of S(ocial) and R(eserved) – representative of the larger population. I’d assume this is because questions in this trait were very straightforward (e.g. “I start conversations”), and users likely display/are conscious of these behaviors in their everyday life. Hence, users will have a  more ‘objective’ viewpoint, leading to more accurate results. 

There are also about ~40k more introverts compared to extroverts. Maybe the Sociables aren’t as likely to spend 20 minutes on an online test, compared to the Reserved? 


**Neuroticism**

Once again, a solid distribution of results between C(alm) and L(imbic), mirroring what I’d expect the general population to be like. Similar to the extrovertism section, the questions tend to be straightforward and (I think) there’s less self-bias within the trait, as I believe that many people are conscious of their experience with their emotions emotions, and whether or not they control them.  

There are ~60000 more limbic people compared to calm. I’m not really surprised - people are more stressed^[<a href="https://www.wbur.org/hereandnow/2022/07/13/stress-survey-gallup" target="_blank">Source.</a>] and more sad^[<a href="https://www.voanews.com/a/why-people-worldwide-are-unhappier-more-stressed-than-ever-/6658784.html" target="_blank">Source.</a>] than we’ve ever been. Furthermore, emotional regulation is a result of introspection and reflection. As our society slowly moves towards constant stimulation and overindulgence, it’s no wonder we struggle to achieve emotional stability. 

**Conscientiousness, Agreeableness, and Openness**

With these three personality traits, we start to see a much larger gap between the possible letters. There are significantly more results that are organized, agreeable, and inquisitive, relative to unstructured, egocentric, and non-inquisitive. 

I don’t think these results genuinely reflect the general population, even though I have no evidence stating so. However, if I had to speculate, I’d say that this data is a bit biased and leads to skewed results. 

1. We’re just a little bit tainted 

No matter how hard we try, we can never be completely objective. Many struggle to see things beyond ourselves and to judge every action we take from a neutral standpoint. 

In our daily lives, this is not too significant of an issue. A little bit of subjectivity never hurt anybody! However, when we’re trying to objectively analyze and record data about ourselves, our lack of objectivity can lead to delusional answers and incorrect results - especially since this is a self-administrated quiz.

2. We’re fragile creatures

In this society, it is almost ALWAYS better if you’re organized, agreeable, and inquisitive, rather than the opposite. In fact, it’s almost an insult if we AREN’T these things.^[If someone told you, “Yea, you’re just a bit egocentric… no offense”, would you be happy about it?] 

For example, people tend to be more agreeable and people-pleasing, since it shows that you’re friendly and nice. Then, because you exhibit these behaviours people will tend to ‘like’ you more (relative to being confrontational and assertive for your own needs). Similar comparisons can be made for conscientiousness, especially as our society moves towards maximizing productivity and ‘grind culture’. You NEED to be conscientious and self-disciplined, or else you won’t be successful.  Or, in relation to inquisitivity, people don’t want to be seen as rigid and unwilling to try new things. Society will call them scaredy-cats, boring, or tell them that you’re ‘bringing the mood down’. 

It doesn’t help that we don’t like being ‘bad people’ – we constantly attempt to justify our actions to be good and perceive ourselves in a positive light. We are rarely the villains in our own stories; it’s always the other person doing something wrong, or doing something worse than we did, or they started the ordeal.

However, when we can’t be objective, we can confuse what we actually do, with what we wish we did. This is going to lead us to choose answers corresponding to those ‘better’ traits of self-discipline, agreeableness, and inquisitiveness, instead of objectively saying we have the ‘worse’ traits of unstructuredness, , and un-inquisitiveness.

3. We’re just built for this (for Openness)

There’s also the classic case of sampling bias. The people who take this quiz are probably curious about psychology, want to know more about themselves, and are willing to try something new. These are typically the types of people who are inquisitive (matching with the I letter) instead of non-inquisitive (matching with the N letter). 


**Sheer Statistical Impossibility...?** 

When analyzing this data, it seems.. strange that so many __OAI types are represented. In fact, it feels weird that 15% (!!!!) of people were the EXACT SAME TYPE, despite ALL POSSIBLE COMBINATIONS! 

So, let's see how it compares to the theoretical data. Using the data^[This was the only site that had theoretical values, but I don't know where they got their percentages from. It should also be noted that this site does not use 'X' as a possible result. E.g. XLUEI (or any combination with an 'X') is not considered. So, this means that there is no data for specific combinations. Hence, the theoretical values should be trusted with a grain of salt. It should also be noted that SimilarMinds separates the theoretical values by female and male. Since this data set does not have this distinction, I used the average of the male and female theoretical values to get my average number.] from [SimilarMinds](https://similarminds.com/global5/rcoai.html), we can see how our data stacks up. 


```{r}

 theorytable <- select(pfinaltable, Results) %>%
   mutate("Percentage of People" = c(3.4, 2.7, 2.5, 3.5, "N/A", 3.4, 4.1, "N/A", "N/A", "N/A"))

expertable <- select(pfinaltable, "Results", "Percentage of People")


knitr::kables(list(
  kable(caption = "Theoretical Data",
    theorytable) %>% kable_styling(),
    kable(caption = "Experimental Data",
     expertable
    ) %>% kable_styling()
    
  )
) %>% kable_styling()

```


Looking at these tables, there’s a large discrepancy between theoretical and experimental data, where only SCUAI matches the theoretical results. Clearly, certain results are far more represented in our data set than the average value of the general population. 

I believe that most of it can be explained by the previous analysis: Wrong results might occur because of biases and societal norms (cementing the last two letters to be A and I and increasing the likelihood of an O vs. an U), in addition to the natural disposition of respondents. 

Honestly, I’m not too sure why 15% of people are SCOAI, maybe people are being influenced to answer what they WANT to be like, rather than what they actually are. My best guess is that SCOAI seems like one of the most 'socially-successful’ results, since extroverted, stable, organized, agreeable, and inquisitive are all attributes that allow people to thrive in this society. They tend to have larger social circles, better interpersonal relationships and private lives, and the ability to study and work hard to achieve their goals. 

So, my best guess is that many respondents are not actually SCOAIs, and they're not answering these questions objectively.^[If you have more ideas, I’d love to hear them! Reach out :)]

Also, just to provide a comprehensive review of the results, here's a list of the most uncommon ones! 

```{r, unpoptable}
pfinaltableasc <- finaltable %>% 
  unnest(finalletters) %>%
  group_by(finalletters) %>%
  summarize(total = n()) %>%
  arrange(total) %>%
  slice(1:10)

colnames(pfinaltableasc) <- c("Results", "Amount of Responses")

knitr::kable(pfinaltableasc,
             caption = "Most Uncommon Results") %>% kable_styling(position = "center")

```

No surprise, it's a lot of results with X's!

At first, I was surprised that 'XXXXX' didn't appear, since I'd assume it (theoretically) is the most unlikely.^[There are actually 3794 people who got  XXXXX in this data set.] However, I wouldn't be surprised if only 5% of XXXXX respondents were genuinely XXXXX, while the other 95% of people who got the result just kept clicking 3 (Neutral) for every question, or had some kind of game to see if they could get the (theoretically) super rare XXXXX. 

### Do results vary between countries? <a name="country"></a>

This data contains 224 unique ISO country codes.^['Country codes' are kinda misleading. There are ~195 countries, and ISO has 249 different codes. This is because the ISO contains subdivisions of countries, e.g. Caymen Islands (UK) and Christmas Island (Australia).] Let's dig through this data - a fun bit of stalking!

```{r, country data}


countres <- data %>% 
  select('country') %>%
  group_by(country) %>%
  summarize(total = n()) %>%
  arrange(desc(total)) %>% 
  slice(1:25)


ggplot(data= countres, mapping = aes(x = reorder(country, total), y = total))+
  geom_col(fill = "steelblue")+
  theme_classic()+
  labs(title = "Locations of Respondents", 
       subtitle = "OH SAY, CAN YOU SEEEEE!", 
       y = "Amount of Responses", 
       x = "Location") + coord_flip()

```

We can see that the majority of data came from the US, with a whopping total of 546403 US respondents. Trailing (very far) behind, we also have Great Britain (GB), Canada (CA), and Australia (AU). 

This is likely because this quiz is in English, hence, generally caters towards countries with English as their primary language. In addition, Google's SEO (search engine optimization) algorithm is also affected by location and will rank websites by their proximity to the user.^[<a href="https://www.searchenginejournal.com/ranking-factors/physical-proximity-to-searcher" target="_blank">Source.</a>] So, it's possible that Open Psychometrics is located in America,^[I couldn't find any specific location data on the website.] and when Americans search up "Big Five Personality Test", this would be the first quiz that shows up.^[As a Canadian, it's actually the third search result!]

But, we're not really concerned about WHERE people are taking the quiz. Instead, we only care about how it affects the responses. Hence, we're going to start by finding the most common results for America, Great Britain, Australia, and the Philippines -- these locations have the greatest number of results while being from different continents -- and see how they compare to one another. 

```{r}
coutdata <- cbind(finaltable$finalletters, data$country) 


## US Data 
colnames(coutdata) <- c('Results', 'Country')
coutdata <- data.table::as.data.table(coutdata, .keep.rownames = "word")

usdata <- coutdata[coutdata$Country %in% "US"]

usdataslice <- usdata %>% 
  select('Results') %>%
  group_by(Results) %>%
  summarize(Percentage = n()/546403*100) %>%
  arrange(desc(Percentage)) %>% 
  slice(1:10)


## GB
gbdata <- coutdata[coutdata$Country %in% "GB"]
colnames(gbdata) <- c('Results', 'Country')

gbdataslice <- gbdata %>% 
  select('Results') %>%
  group_by(Results) %>%
  summarize(Percentage = n()/66596*100) %>%
  arrange(desc(Percentage)) %>% 
  slice(1:10)



#Aus
audata <- coutdata[coutdata$Country %in% "AU"]
colnames(audata) <- c('Results', 'Country')

audataslice <- audata %>% 
  select('Results') %>%
  group_by(Results) %>%
  summarize(Percentage = n()/50030*100) %>%
  arrange(desc(Percentage)) %>% 
  slice(1:10)

##Ph
phdata <- coutdata[coutdata$Country %in% "PH"]
colnames(phdata) <- c('Results', 'Country')

phdataslice <- phdata %>% 
  select('Results') %>%
  group_by(Results) %>%
  summarize(Percentage = n()/19847*100) %>%
  arrange(desc(Percentage)) %>% 
  slice(1:10)


knitr::kables(list(
  kable(caption = "America", usdataslice) %>% kable_styling(),
  kable(caption = "Great Britian", gbdataslice) %>% kable_styling(),
  kable(caption = "Australia", audataslice) %>% kable_styling(),
  kable(caption = "Philippines", phdataslice) %>% kable_styling()
  )
) %>% kable_styling()

```


From the table above, it's pretty clear that countries have very similar trends. However, there are slight differences: 

- The Philippines tends to be more introverted than extroverted. 
- The Philippines tends to be more limbic than calm. 
- The Philippines is the only location to have an 'X' appear in their results.
- The Philippines contains the only 'N', instead of 'I'.
- Great Britain has the 'least variation' in regards to their percentage (Their percentage column has the smallest range).
- 'E' only appears 7 times, relative to the 33 appearances of 'A'.
- Every result in this table also appears in the top 25 most common results.


**Generalizing the World**

We can also plot the trait averages on a world map, and then analyze the results. 

A note on the data: Locations with less than 10 responses have been omitted from the map data, as they often significantly skew the scale of the maps. This removed 58 locations off the map, with Africa losing a pretty big chunk of their land. 


```{r, filterredcount}
redcount <- c('AS', 'RE', 'CK', 'NC', 'PF', 'TC', 'TL', 'VU', 'XK', 'LI', 'MP', 'SL', 'FM', 'LR', 'MC', 'MQ', 'SS', 'SH', 'TO', 'AI', 'GA', 'GP', 'SX', 'CD', 'CG', 'ML', 'MR', 'PW', 'TG', 'VG', 'AQ', 'BF', 'BJ', 'BQ', 'DJ', 'GF', 'MS', 'NU', 'PM', 'SM', 'TJ', 'BI', 'FK', 'GN', 'GQ', 'KM', 'MF', 'MH', 'NE', 'SH', 'TD', 'NE', 'TD', 'PW', 'KM', 'TJ', 'GQ', 'ML')

colnames(data)[108] <- "region"

for (i in redcount) {
  data<- filter(data, region!=i)
}

exttable <- data %>% 
  select(starts_with('EXT'))  
exttable <- exttable %>% select(-c (ends_with('E'))) %>% 
  mutate(extscore = (EXT1-3) - (EXT2-3) + (EXT3-3) - (EXT4-3) + (EXT5-3) - (EXT6-3) + (EXT7-3) - (EXT8-3) + (EXT9-3) - (EXT10-3))


 esttable <- data %>% select(starts_with('EST'))
 esttable <- esttable %>% select(-c (ends_with('E'))) %>%
   mutate(estscore = (EST2-3) - (EST1-3) - (EST3-3) + (EST4-3)  - (EST5-3)- (EST6-3)- (EST7-3)- (EST8-3)- (EST9-3)- (EST10-3)) 

 
  csntable <- data %>% 
  select(starts_with('CSN'))


 csntable <- csntable %>% select(-c (ends_with('E'))) %>% 
   mutate(csnscore = (CSN1-3) - (CSN2-3) + (CSN3-3) - (CSN4-3) + (CSN5-3) - (CSN6-3) + (CSN7-3) - (CSN8-3) + (CSN9-3) + (CSN10-3))
 
 
  agrtable <- data %>% select(starts_with('AGR'))
 agrtable <- agrtable %>% select(-c (ends_with('E'))) %>% 
   mutate(agrscore = (AGR2-3) - (AGR1-3) + (AGR4-3) - (AGR3-3) + (AGR6-3) - (AGR5-3) + (AGR8-3) - (AGR7-3) + (AGR10-3) + (AGR9-3))
 
  opntable <- data %>% select(starts_with('OPN'))
 opntable <- opntable %>% select(-c (ends_with('E'))) %>% 
   mutate(opnscore = (OPN1-3) - (OPN2-3) + (OPN3-3) - (OPN4-3) + (OPN5-3) - (OPN6-3) + (OPN7-3) + (OPN8-3) + (OPN9-3) + (OPN10-3)) 
## OVERHERE
```


```{r extscores world map, layout="l-body-outset"}

exttablec <- exttable %>% 
  cbind(data$region)

colnames(exttablec)[12] <- "region"

exttablec <- exttablec %>%
  group_by(region) %>%
  drop_na 


exttablec$region <- countrycode(exttablec$region, "iso2c", "country.name")  

extworld <- exttablec %>% 
  group_by(region) %>%
  summarize(ExtScores = mean(extscore))

world_map = map_data("world") 
world_map$region[world_map$region == 'USA'] <- 'United States'

colnames(world_map)[1] <- "Longitude"
colnames(world_map)[2] <- "Latitude"


mergemapext <- inner_join(world_map, extworld, by = "region")


pext <- ggplot() +
  geom_polygon(data=mergemapext,
          aes(x=Longitude, y=Latitude, group=group, fill = ExtScores, label=region),
          color="white", size = 0.2) + 
  coord_cartesian(ylim = c(-50, 90)) + 
  labs(
    title="Extroversion Scores of the World",
    fill="Extroversion
Averages", 
  )+ theme_minimal() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(),axis.title.y = element_blank())

ggplotly(pext)


```

Higher scores are correlated with extroversion, lower scores are correlated with introversion. 

```{r, extworldtable}

topext <- extworld %>%
  arrange(ExtScores) %>%
  head()

botext <- extworld %>%
  arrange(desc(ExtScores)) %>%
  head()

  
knitr::kables(list(
  kable(caption = "Most Extroverted", botext) %>% kable_styling(),
  kable(caption = "Least Extroverted", topext) %>% kable_styling()
  )
) %>% kable_styling()

```

There doesn't seem to be an overarching trend in the world, but there are several generalizations. 

- North America is slightly more introverted than extroverted. 
- South America is more introverted than extroverted.
- South and East Asia is slightly more extroverted than introverted.
- Africa has a diverse smattering of extroversion/introversion scores. 
- Europe is more introverted than extroverted. 

It's quite interesting that Americans are stereotyped to be more extroverted and loud, while Asians are more introverted and quiet. Doesn't seem to apply to this data set!


```{r, est world map, layout="l-body-outset"}

esttablec <- esttable %>% 
  cbind(data$region)

colnames(esttablec)[12] <- "region"

esttablec <- esttablec %>%
  group_by(region) %>%
  drop_na 



esttablec$region <- countrycode(esttablec$region, "iso2c", "country.name")  

estworld <- esttablec %>% 
  group_by(region) %>%
  summarize(estScores = mean(estscore))


mergemapest <- inner_join(world_map, estworld, by = "region")

pest <- ggplot() +
  geom_polygon(data=mergemapest,
          aes(x=Longitude, y=Latitude, group=group, fill = estScores, label=region),
          color="white", size = 0.2) + 
  coord_cartesian(ylim = c(-50, 90)) + 
  labs(
    title="Neuroticism Scores of the World",
    subtitle="Africa is feeling colorful!",
    fill="Neuroticism  
Averages", 
  )+ theme_minimal() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(),axis.title.y = element_blank())

ggplotly(pest)
```

Higher scores are correlated with being calm, lower scores are correlated with being limbic.  


```{r, estworldtable}

topest <- estworld %>%
  arrange(estScores) %>%
  head()

botest <- estworld %>%
  arrange(desc(estScores)) %>%
  head()


  

knitr::kables(list(
  kable(caption = "Most Calm", botest) %>% kable_styling(),
  kable(caption = "Least Calm", topest) %>% kable_styling()
  )
) %>% kable_styling()

##RENAME LEGEND TITLES

```

It seems like the southeastern part of the world is less limbic, specifically Africa and East Asia. I find it funny that China is relatively 'calm', despite their notoriety for bad work-life balances^[E.g. the 996 schedule of working from 9 am to 9 pm, 6 days a week.] and the 'lie down' movement^[Youth in China are adopting the philosophy of 'lying down' and giving up, due to the bad job market after graduation. They often feel let down by their society, as students have been taught that studying hard and getting into a good university will lead to a good life. Yet, when they graduate, they struggle to find jobs and keep themselves afloat.] -- factors that would propagate negative moods and emotional instability.

Yet, it's also reasonable to say that Chinese people are accustomed to high stress after dealing with academic pressures.^[E.g. To get into university, students take the Gaokao, a two-day standardized test that determines their entire future.] Hence, they might have learned to better regulate their emotions. 


```{r, csn world map, layout="l-body-outset"}

csntablec <- csntable %>% 
  cbind(data$region)

colnames(csntablec)[12] <- "region"

csntablec <- csntablec %>%
  group_by(region) %>%
  drop_na 

csntablec$region <- countrycode(csntablec$region, "iso2c", "country.name")  


csnworld <- csntablec %>% 
  group_by(region) %>%
  summarize(csnScores = mean(csnscore))


mergemapcsn <- inner_join(world_map, csnworld, by = "region")


pcsn <- ggplot() +
  geom_polygon(data=mergemapcsn,
          aes(x=Longitude, y=Latitude, group=group, fill = csnScores, label=region),
          color="white", size = 0.2) + 
  coord_cartesian(ylim = c(-50, 90)) + 
  labs(
    title="Conscientiousness Scores of the World",
    subtitle="Africa is feeling colorful!",
    fill="Conscientiousness 
Averages", 
  )+ theme_minimal() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(),axis.title.y = element_blank())

ggplotly(pcsn)


```

Higher scores are correlated with organization and contentiousness, lower scores are correlated with carelessness.  

```{r, csnworldtable}

topcsn <- csnworld %>%
  arrange(csnScores) %>%
  head()


botcsn <- csnworld %>%
  arrange(desc(csnScores)) %>%
  head()

  

knitr::kables(list(
  kable(caption = "Most Contentious", botcsn) %>% kable_styling(),
  kable(caption = "Least Contentious", topcsn) %>% kable_styling()
  )
) %>% kable_styling()

```

For conscientiousness, Africa is lit up like a Christmas tree! North America is also pretty light. On the other hand, South America is quite dark. 


I find it interesting that Asia, which is known for their disciplined schedules and focus, seems to be quite average. Furthermore, Sub-Saharan Africa seems to be incredibly conscientious - yet, there's a direct link between low conscientiousness and poverty.^[<a href="https://www.econlib.org/archives/2009/03/econlog_book_cl_10.html" target="_blank">Report discussing link of poverty and conscientiousness</a>,
<a href="https://issafrica.org/iss-today/africa-is-losing-the-battle-against-extreme-poverty" target="_blank">report of poverty in Sub-Saharan Africa</a>] Is this just another instance of self-bias? 


```{r, agr world map, layout="l-body-outset"}

agrtablec <- agrtable %>% 
  cbind(data$region)

colnames(agrtablec)[12] <- "region"

agrtablec <- agrtablec %>%
  group_by(region) %>%
  drop_na 

agrtablec$region <- countrycode(agrtablec$region, "iso2c", "country.name")  


agrworld <- agrtablec %>% 
  group_by(region) %>%
  summarize(agrScores = mean(agrscore))

mergemapagr <- inner_join(world_map, agrworld, by = "region")


pagr <- ggplot() +
  geom_polygon(data=mergemapagr,
          aes(x=Longitude, y=Latitude, group=group, fill = agrScores, label=region),
          color="white", size = 0.2) + 
  coord_cartesian(ylim = c(-50, 90)) + 
  labs(
    title="Agreeableness Scores of the World",
    subtitle="Africa is feeling colorful!",
    fill="Agreeableness
Averages", 
  )+ theme_minimal() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(),axis.title.y = element_blank())

ggplotly(pagr)

##Only one td,ne score, km, pw, tj, GQ

```

Higher scores are correlated with agreeableness, lower scores are correlated with egocentrism.  



```{r, agrworldtable}

topagr <- agrworld %>%
  arrange(agrScores) %>%
  head()

botagr <- agrworld %>%
  arrange(desc(agrScores)) %>%
  head()


knitr::kables(list(
  kable(caption = "Most Agreeable", botagr) %>% kable_styling(),
  kable(caption = "Least Agreeable", topagr) %>% kable_styling()
  )
) %>% kable_styling()

```


I had to double check twice to make sure I didn't accidentally duplicate the conscientiousness graph, as they look almost identical. 

I am, once again, not surprised that everybody thinks they're agreeable. When looking at the scores on the 'least agreeable' table, not a single country is willing to admit they're... *just a tiny bit* egotistical! Alas, the bias goes deep. 

```{r opn world map, layout="l-body-outset"}

opntablec <- opntable %>% 
  cbind(data$region)

colnames(opntablec)[12] <- "region"

opntablec <- opntablec %>%
  group_by(region) %>%
  drop_na 


opntablec$region <- countrycode(opntablec$region, "iso2c", "country.name")  


opnworld <- opntablec %>% 
  group_by(region) %>%
  summarize(opnScores = mean(opnscore))

mergemapopn <- inner_join(world_map, opnworld, by = "region")


popn <- ggplot() +
  geom_polygon(data=mergemapopn,
          aes(x=Longitude, y=Latitude, group=group, fill = opnScores, label=region),
          color="white", size = 0.2) + 
  coord_cartesian(ylim = c(-50, 90)) + 
  labs(
    title="Openness Scores of the World",
    fill="Openness
Averages", 
  )+ theme_minimal() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(),axis.title.y = element_blank())

ggplotly(popn)


# https://rstudio.github.io/distill/figures.html for making figures expand 
#figure out better words for inquistiion/not oppeness
```

Higher scores are correlated with inquisition, lower scores are correlated with traditionalists. 



```{r, opnworldtable}

topopn <- opnworld %>%
  arrange(opnScores) %>%
  head()


botopn <- opnworld %>%
  arrange(desc(opnScores)) %>%
  head()

  

knitr::kables(list(
  kable(caption = "Most Inquisitive", botopn) %>% kable_styling(),
  kable(caption = "Least Inquisitve", topopn) %>% kable_styling()
  )
) %>% kable_styling()

```

The Americas, Africa, and Europe seem to be a lot more open to new experiences, as they're significantly brighter than the other continents. I can only think that risk-taking is just encouraged inside these societies or people are given more personal freedom and allowed more individuality. However, in other locations, they may prioritize stability and traditional methods -- not necessarily a bad thing. 

### Are All Questions Created Equal? <a name="questions"></a>

We can also analyze the questions themselves. This quiz actually recorded how many milliseconds each respondent spent on each question.^[The timer starts when you select an answer to a previous question and runs until you answer the current question. The first question's timer starts when you load into the page.] 

Thus, I present to you: The amount of time spent on each question!

```{r, rtimext}
rtimeext <- data %>%
  select(c (ends_with('_E'))) %>% 
  select(c(starts_with('EXT'))) %>%
  sapply("/", 1000)

rtimeext=as.data.frame(rtimeext)

rtimeext <- rtimeext %>%
  filter(EXT1_E < 20) %>%
  filter(EXT2_E < 20) %>%
  filter(EXT3_E < 20) %>%
  filter(EXT4_E < 20) %>%
  filter(EXT5_E < 20) %>%
  filter(EXT6_E < 20) %>%
  filter(EXT7_E < 20) %>%
  filter(EXT7_E > 0) %>%
  filter(EXT8_E < 20) %>%
  filter(EXT9_E < 20) %>%
  filter(EXT10_E < 20) %>%
  slice(1:1000) %>%
  select(-EXT10_E,everything())


rqextp<-rtimeext  %>%  
  pivot_longer(everything(), values_to="Seconds", names_to="Question") %>% 
  ggplot() +
  geom_boxplot(aes(x=Question, y=Seconds))

```

```{r}
###
rtimeCSN <- data %>%
  select(c (ends_with('_E'))) %>% 
  select(c(starts_with('CSN'))) %>%
  sapply("/", 1000)

rtimeCSN=as.data.frame(rtimeCSN)

rtimeCSN <- rtimeCSN %>%
  filter(CSN1_E < 20) %>%
  filter(CSN2_E < 20) %>%
  filter(CSN3_E < 20) %>%
  filter(CSN4_E < 20) %>%
  filter(CSN5_E < 20) %>%
  filter(CSN6_E < 20) %>%
  filter(CSN7_E < 20) %>%
  filter(CSN7_E > 0) %>%
  filter(CSN8_E < 20) %>%
  filter(CSN9_E < 20) %>%
  filter(CSN10_E < 20) %>%
  slice(1:1000) %>%
  select(-CSN10_E,everything())


rqcsnp <- rtimeCSN  %>%  
  pivot_longer(everything(), values_to="Seconds", names_to="Question") %>% 
  ggplot() +
  geom_boxplot(aes(x=Question, y=Seconds))

###
rtimeEST <- data %>%
  select(c (ends_with('_E'))) %>% 
  select(c(starts_with('EST'))) %>%
  sapply("/", 1000)

rtimeEST=as.data.frame(rtimeEST)

rtimeEST <- rtimeEST %>%
  filter(EST1_E < 20) %>%
  filter(EST2_E < 20) %>%
  filter(EST3_E < 20) %>%
  filter(EST4_E < 20) %>%
  filter(EST5_E < 20) %>%
  filter(EST6_E < 20) %>%
  filter(EST7_E < 20) %>%
  filter(EST7_E > 0) %>%
  filter(EST8_E < 20) %>%
  filter(EST9_E < 20) %>%
  filter(EST10_E < 20) %>%
  slice(1:1000) %>%
  select(-EST10_E,everything())


rqestp <- rtimeEST  %>%  
  pivot_longer(everything(), values_to="Seconds", names_to="Question") %>% 
  ggplot() +
  geom_boxplot(aes(x=Question, y=Seconds))

###
rtimeAGR <- data %>%
  select(c (ends_with('_E'))) %>% 
  select(c(starts_with('AGR'))) %>%
  sapply("/", 1000)

rtimeAGR=as.data.frame(rtimeAGR)

rtimeAGR <- rtimeAGR %>%
  filter(AGR1_E < 20) %>%
  filter(AGR2_E < 20) %>%
  filter(AGR3_E < 20) %>%
  filter(AGR4_E < 20) %>%
  filter(AGR5_E < 20) %>%
  filter(AGR6_E < 20) %>%
  filter(AGR7_E < 20) %>%
  filter(AGR7_E > 0) %>%
  filter(AGR8_E < 20) %>%
  filter(AGR9_E < 20) %>%
  filter(AGR10_E < 20) %>%
  slice(1:1000) %>%
  select(-AGR10_E,everything())


rqagrp<- rtimeAGR  %>%  
  pivot_longer(everything(), values_to="Seconds", names_to="Question") %>% 
  ggplot() +
  geom_boxplot(aes(x=Question, y=Seconds))

###
rtimeOPN <- data %>%
  select(c (ends_with('_E'))) %>% 
  select(c(starts_with('OPN'))) %>%
  sapply("/", 1000)

rtimeOPN=as.data.frame(rtimeOPN)

rtimeOPN <- rtimeOPN %>%
  filter(OPN1_E < 20) %>%
  filter(OPN2_E < 20) %>%
  filter(OPN3_E < 20) %>%
  filter(OPN4_E < 20) %>%
  filter(OPN5_E < 20) %>%
  filter(OPN6_E < 20) %>%
  filter(OPN7_E < 20) %>%
  filter(OPN7_E > -1) %>%
  filter(OPN8_E < 20) %>%
  filter(OPN9_E < 20) %>%
  filter(OPN10_E < 20) %>%
  slice(1:1000) %>%
  select(-OPN10_E,everything())


rqopnp <- rtimeOPN  %>%  
  pivot_longer(everything(), values_to="Seconds", names_to="Question") %>% 
  ggplot() +
  geom_boxplot(aes(x=Question, y=Seconds))


rqextp
rqcsnp
rqestp
rqagrp
rqopnp

```


For your reference: 

- EXT = Extroversion (S/R)
- EST = Neuroticism (L/C)
- CSN = Organization (O/U)
- AGR = Agreeableness (A/E)
- OPN = Openness (N/I)

I really like using a box plot^[I actually forgot this type of graph existed, until I was randomly scrolling through the ggplot2 library of different graph types!] to symbolize these results. For those who are unaware, the white box symbolizes the interquartile range (the range of values encompassing 25th to 7th percentiles. The lower end of the box represents the bottom 25%, while the top end of the box represents the top 25% of users. The line in the center is the median value -- in this case, the median time taken for each question.^[<a href="https://en.wikipedia.org/wiki/Interquartile_range" target="_blank">Learn more here.</a>] Box plots are great for visualizing the spread of data (which seems to range quite a bit) and managing outliers. 

Notice for the data: I've cutoff values above 20 seconds^[As they are significant outliers and make the data difficult to visualize. These values are only omitted for the graphing aspect and are still kept for the analysis of the data, such as the analysis below.] in the graph. I've also taken a sample of 50000 response times for each question.^[50000 is enough to show the general trend, and utilizing more values only makes graphs take longer to load.] 

However, I want to be more precise when analyzing loading times, so I've specifically pulled the questions that take the longest and shortest times to complete. 


```{r, questiontimes}
qtime <- data %>%
  select(c (ends_with('_E')))

qtimeframe <- data.frame(qtime)  %>%
  slice(1:50000) %>%
  colMeans()


qtimes <- data.table::as.data.table(qtimeframe, .keep.rownames = "word")
qcolnames <- colnames(qtime) 


qtimes <- mutate(qtimes, question = qcolnames) %>%
  select(question, everything())%>%
  arrange(desc(qtimeframe)) %>% 
  subset(question != "EXT1_E")


highqtime <- qtimes %>%
  slice(1:5) %>% 
  mutate(qtimeframe =  qtimeframe/1000) %>%
  mutate(qs = c("I feel little concern for others.", "I don't talk a lot.", "I worry about things.", "I am always prepared.", "I make a mess of things.")) %>%
  relocate(question, qs, qtimeframe)


lowqtime <- qtimes %>%
  slice (45:50) %>% 
  mutate(qtimeframe =  qtimeframe/1000) %>%
  mutate(qs = c("I am quiet around strangers.","I get irritated easily.", "I follow a schedule.", "I use difficult words.", "I am full of ideas."))%>%
  relocate(question, qs, qtimeframe)

colnames(highqtime) <- c("Category", "Question", "Average Time in Seconds")
colnames(lowqtime) <- c("Category", "Question", "Average Time in Seconds")

knitr::kables(list(
  kable(caption = "Questions That Took the Longest", highqtime) %>% kable_styling(),
  kable(caption = "Questions That Took the Shortest", lowqtime) %>% kable_styling()
  )
) %>% kable_styling()
```
I've taken the liberty of removing EXT_1 (the first question on the quiz), which had an average score of 87 seconds. I'd assume it's skewed because people might have wanted to scroll around the webpage and get accustomed to it (instead of immediately focusing on the first question) or maybe started the quiz then forgot about it.^[Recall that the timer for question 1 starts as soon as the page loads (since there are no previous questions to start from).] 

"I feel little concern for others" seems to be the question that took  the longest. It's likely because it's incredibly situational - 'others' is very vague. Does it count if you care about everybody, including strangers or people you hate? Or should you just limit it to your friends, people you may feel an obligation to care about, or want to care about? This 'situational' factor also plagues the other high-ranking questions, where there are SOMETIMES you agree with the actions and other times you don't. There's a lot of nuance that people need to consider, hence, requiring a longer response time.  


On the other hand, the questions that took the least amount of time were concise, straightforward, contained simple words, and were easy to judge yourself on. You either talk pretentiously to seem smart, or you don't.^[I'm referring to the difficult words question.] You can also see that these questions are the ones that are asked later (i.e. A majority of the questions have an XXX9_E tag, meaning that it's part of the 9th out of 10 rounds of questions, so they'd be the 40th - 45th question they've completed). Anticipation for results may have caused them to rush through the later questions. The reverse is also seen. (i.e. The questions that took the longest show up a lot earlier in the quiz, such as AGR1_E, which would've been in the first round of questions).  

Another interesting thing to note is the distribution of answers for each question. You may expect that each question has a distribution similar to standard distribution. However, that's actually not the case! There are various patterns you can spot: 

```{r}

agr1p <- data %>%
  select('AGR1') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")

agr1g<- ggplot(data=agr1p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I shirk my duties.",
     subtitle = "I think we've solved procrasination") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()

###
est3p <- data %>%
  select('AGR6') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")

est3g <- ggplot(data=est3p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I have a soft heart",
     subtitle = "Wholesome :)") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()

###

agr8p <- data %>%
  select('AGR8') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")


agr8g <- ggplot(data=agr8p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I am relaxed most of the time.",
     subtitle = "Stress balls work..?") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()

###

csn4p <- data %>%
  select('CSN4') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")


csn4g<- ggplot(data=csn4p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I feel little concern for others.	",
     subtitle = "Can't believe that the Internet is nice") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()


csn8p <- data %>%
  select('CSN8') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")

csn8g <- ggplot(data=csn8p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I don’t like to draw 
attention to myself.",
     subtitle = "...") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()

est9p <- data %>%
  select('EST9') %>%
  pivot_longer(everything(), values_to="Answers", names_to="Question") %>%
  filter(Answers != "0")


est9g <- ggplot(data=est9p, aes(x=Answers)) +
   geom_bar(fill="steel blue") +
   labs(
     title = "I have excellent ideas.",
     subtitle = "THINK GOOD!\n10B STARTUP IDEA STAT!") + 
   xlab("Respondent's Possible Answers") +
   ylab("Amount of Responses")+
   theme_minimal()


#grid.arrange(agr1g, est3g, agr8g, csn4g, csn8g, ncol=2)
plot_grid(agr1g, est3g, agr8g, csn4g, ncol = 2, align = "hv")
plot_grid(csn8g, est9g, ncol = 2, align = "hv")


```

There are four major types of distribution seen in the data: 

**1. Logarithmic (First Row, i.e. I shirk my duties and I have a small heart)**

The columns progressively increase or decrease. I think these graphs are the most "trustworthy", as you'd only put 1 or 5 (the extremes) if you were incredibly confident in your answer.^[I.e. If you ask people to choose a number between 1 and 5, they tend to pick 2, 3, or 4, rather than 1 or 5.] Not only that, but these questions aren't really 'shameful' to admit, like "I get stressed out easily" is seen to be a relatively normal thing to say, which allows people to be honest and pick extremes. 

Questions also tend to be less 'situational' and more 'specific', where you can very clearly visualize what you'd be doing in that situation, rather than responding "Oh... sometimes I am, sometimes I'm not!" (E.g. "I am quiet" likely wouldn't follow this trend, but "I am quiet around strangers" does because the question narrows down the situation. You also don't really change your behavior around different strangers - it's pretty consistent.)

Some other examples include: 

- I have difficulty understanding abstract ideas.
- I am quiet around strangers.
- I spend time reflecting on things.

If you're wondering which side they skew on.... just trust your gut on it :)

**2. Skewed (Second Row, i.e. I am relaxed most of the time, I feel litte concern for others)**

This is the most common distribution type. I feel like these are best associated with questions where self-bias is most prevalent, as you want to pretend you're something you're not (to make yourself feel better). These questions are also very situational; Sometimes I do this, sometimes I do. That's why people tend to lean towards the middle. 

Examples include: 

- I make a mess of things.
- I get stressed out easily.  
- I leave my belongings around. 
- I follow a schedule. 

**3. "Normal" Distribution (Third Row, Left Plot)**

I'm lying to you. These graphs don't have normal distributions. I'm just calling it normal distribution because the answer 3 (the middle) is the most common -- similar to a normal distribution graph. Quite frankly, I think this pattern means that people are either confused or they don't really have a large opinion on it, so they're almost forced to choose 3. These questions also seem to be the most 'observable/objective' of the bunch.

Personally, I try to make a habit of not selecting 3 on these tests (I'm not sure if others are the same), but it's still interesting to see. I feel like these things are not things to be 'proud' of or dislike about yourself, nor would you mention it unless prompted, which is likely why it's typically associated with the extrovertism questions. 

Examples Include: 

- I don't talk a lot.
- I keep in the background.

**4. Relatively Uniform (Third Row, Right)** 

These are the ones that have relatively more uniform distribution, as 1 and 5 are similar in height and have about 150k responses, while  3, 4, and 5 are also similar in height with about 250k responses. These questions are the ones you go "Yea... I'm definitely not SUPER ___, but it happens from time to time... I'm not sure how I would compare with other people though... so 2, 3, or 4 sound about right."

Examples Include: 

- I talk to a lot of different people at parties.
- I am easily disturbed.
- I often forget to put things back in their proper place.^[This one is almost inverted, where 2 and 4 are the most common responses, followed by 1 and 5, then 3.]
- I change my mood a lot.


### Learn More Theory
Explore the Big Five Test beyond this dataset. Continue to ['Beyond the Dataset'](fivebeyond.html) to learn about the test's history, common critiques, and connections to society and other tests.  

